
{% load static %}
    <style>

        .picture-container {
            position: relative;
            cursor: pointer;
            text-align: center;
            }
        .picture {
            width: 106px;
            height: 106px;
            background-color: #999999;
            border: 4px solid #CCCCCC;
            color: #FFFFFF;
            border-radius: 50%;
            margin: 5px auto;
            overflow: hidden;
            transition: all 0.2s;
            -webkit-transition: all 0.2s;
        }
        .picture:hover {
            border-color: #2ca8ff;
        }
        .picture input[type="file"] {
            cursor: pointer;
            display: block;
            height: 100%;
            left: 0;
            opacity: 0 !important;
            position: absolute;
            top: 0;
            width: 100%;
        }
        .picture-src {
            width: 100%;
        }

    </style>

    <div class="container" id="description" style="display: flex; justify-content: center; width: 100%;">
        <form id="cvForm">
            {% csrf_token %}
            <div class="" style="border: 1px solid #45499d; padding: 20px; margin-top: 3em;">

                <div class="picture-container">
                    <div class="picture">
                        <img src="{% static 'assets/img/default-avatar.png' %}" class="picture-src" id="wizardPicturePreview" title=""/>
                        <input type="file" name="photo" id="wizard-picture">
                    </div>
                    <h6>Ajouter Photo</h6>
                </div>
                
                <div class="form-group">
                    <label class="text-primary">Poste actuel ou souhaité</label>
                    <input name="titre" id="titre" required type="text" class="form-control rounded-0" placeholder="Votre profession">
                </div>
                <div class="form-group">
                    <label class="text-primary">Profil</label>
                    <textarea class="form-control rounded-0" required name="description" id="description" cols="30" rows="8"></textarea>
                </div>
                
            </div>
            <div style="display: flex; justify-content: end; margin-top: 5px;"><button style="width: 200px;" class="btn btn-primary">Suivant</button></div>
        </form>
    </div>

    <!-- form formation -->
    {% include "utilisateur/profil/templateCv/Forms/formation.html" %}


    <!-- Form Experience Pro -->
    {% include "utilisateur/profil/templateCv/Forms/experiencePro.html" %}







    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#cvForm').on('submit', function(event) {
                event.preventDefault(); // Empêche le rechargement de la page

                // Récupération des données du formulaire
                const formData = {
                    photo:$('#wizard-picture').val(),
                    titre: $('#titre').val(),
                    description: $('#description').val(),
                    csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
                };

                // Envoi des données avec AJAX
                $.ajax({
                    url: "{% url 'description' personne_id=user.id %}", // Mettre à jour avec la bonne URL
                    type: "POST",
                    data: formData,
                    success: function(response) {
                        // Message de succès
                        $('#message').html('<p style="color:green;">' + response.message + '</p>');

                        // Vider les champs du formulaire
                        $('#cvForm')[0].reset();

                        // Redirection vers la page 'formation'
                        window.location.href = "{% url 'formation' %}";
                    },
                    error: function(xhr) {
                        // Message d'erreur
                        $('#message').html('<p style="color:red;">Une erreur s\'est produite.</p>');
                    }
                });
            });
        });
    </script>

    <script>
        $(document).ready(function() {
            $('#cvForm').on('submit', function(event) {
                event.preventDefault(); // Empêche le rechargement de la page

                // Récupération des données du formulaire
                const formData = {
                    periode:$('#periode').val(),
                    formation: $('#formation').val(),
                    etablissement: $('#etablissement').val(),
                    csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
                };

                // Envoi des données avec AJAX
                $.ajax({
                    url: "{% url 'description' personne_id=user.id %}", // Mettre à jour avec la bonne URL
                    type: "POST",
                    data: formData,
                    success: function(response) {
                        // Message de succès
                        $('#message').html('<p style="color:green;">' + response.message + '</p>');

                        // Vider les champs du formulaire
                        $('#cvForm')[0].reset();

                        // Redirection vers la page 'formation'
                        window.location.href = "{% url 'formation' %}";
                    },
                    error: function(xhr) {
                        // Message d'erreur
                        $('#message').html('<p style="color:red;">Une erreur s\'est produite.</p>');
                    }
                });
            });
        });
    </script>


